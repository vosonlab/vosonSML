#' @title Create an igraph graph from network
#' 
#' @param net A named list of dataframes \code{nodes} and \code{edges} generated by \code{Create}.
#' @param directed Logical. Create a directed graph. Default is \code{TRUE}.
#' @param writeToFile Logical. Save graph to a file in the current working directory. Default is \code{FALSE}.
#' @param ... Additional parameters passed to function. Not used in this method.
#' 
#' @return An igraph object.
#' 
#' @aliases Graph
#' @name vosonSML::Graph
#' @export
Graph <- function(net, directed = TRUE, writeToFile = FALSE, ...) {
  # create igraph object from dataframes
  g <- igraph::graph_from_data_frame(d = net$edges, directed = directed, vertices = net$nodes)
  
  # searches the class list of net for matching method
  UseMethod("Graph", net)
}

#' @noRd
#' @export
Graph.default <- function(...) {
  stop("Unknown network type passed to graph.", call. = FALSE) 
}

#' @noRd
#' @method Graph activity
#' @export
Graph.activity <- function(net, directed = TRUE, writeToFile = FALSE, ...) {
  UseMethod("Graph.activity", net)
}

#' @noRd
#' @export
Graph.activity.default <- function(...) {
  stop("Unknown social media type passed to graph.", call. = FALSE)
}

#' @noRd
#' @export
Graph.activity.twitter <- function(net, directed = TRUE, writeToFile = FALSE, ...) {

  igraph::V(g)$label <- ifelse(!is.na(igraph::V(g)$screen_name), 
                               paste0(igraph::V(g)$name, " (", igraph::V(g)$screen_name, ")"), 
                               igraph::V(g)$name)
  
  if (is.logical(writeToFile) && writeToFile) { 
    writeOutputFile(g, "graphml", "TwitterActivity") 
  } else if (is.character(writeToFile)) {
    writeOutputFile(g, "graphml", writeToFile)
  } 
  
  g
}

#' @noRd
#' @export
Graph.activity.youtube <- function(net, directed = TRUE, writeToFile = FALSE, ...) {
  
  igraph::V(g)$label <- ifelse(!is.na(igraph::V(g)$User), 
                               paste0(igraph::V(g)$name, " (", igraph::V(g)$User, ")"), 
                               igraph::V(g)$name)
  
  if (is.logical(writeToFile) && writeToFile) { 
    writeOutputFile(g, "graphml", "YoutubeActivity") 
  } else if (is.character(writeToFile)) {
    writeOutputFile(g, "graphml", writeToFile)
  }
  
  g
}

#' @noRd
#' @export
Graph.activity.reddit <- function(net, directed = TRUE, writeToFile = FALSE, ...) {
  
  V(g)$label <- ifelse(!is.na(V(g)$user), paste0(V(g)$name, " (", V(g)$user, ")"), V(g)$name)

  if (is.logical(writeToFile) && writeToFile) { 
    writeOutputFile(g, "graphml", "RedditActivity") 
  } else if (is.character(writeToFile)) {
    writeOutputFile(g, "graphml", writeToFile)
  }
  
  g
}

#' @noRd
#' @method Graph actor
#' @export
Graph.actor <- function(net, directed = TRUE, writeToFile = FALSE, ...) {
  UseMethod("Graph.actor", net)
}

#' @noRd
#' @export
Graph.actor.default <- function(...) {
  stop("Unknown social media type passed to graph.", call. = FALSE)
}

#' @noRd
#' @export
Graph.actor.reddit <- function(net, directed = TRUE, writeToFile = FALSE, ...) {
  V(g)$label <- ifelse(!is.na(V(g)$user), V(g)$user, V(g)$name)
  
  if (is.logical(writeToFile) && writeToFile) { 
    writeOutputFile(g, "graphml", "RedditActor") 
  } else if (is.character(writeToFile)) {
    writeOutputFile(g, "graphml", writeToFile)
  }
  
  g  
}
